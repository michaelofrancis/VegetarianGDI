<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Mike Francis" />


<title>Define Vegetarians</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Vegetarianism gene-diet interactions</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Pheno/geno prep
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Phenotype</li>
    <li>
      <a href="UKB_participantQC.html">Participant QC</a>
    </li>
    <li>
      <a href="pheno.html">Prepare phenotype table</a>
    </li>
    <li>
      <a href="skimr.html">Pheno skim</a>
    </li>
    <li class="dropdown-header">Genotype</li>
    <li>
      <a href="genoQC.html">QC genotype bgen files</a>
    </li>
  </ul>
</li>
<li>
  <a href="DefineVeg.html">
    <span class="fa fa-info"></span>
     
    Define Vegetarians
  </a>
</li>
<li>
  <a href="MatchEffect.html">
    <span class="fa fa-solid fa-code-compare"></span>
     
    Matching + exposure analysis
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-solid fa-dna"></span>
     
    Vegetarianism GWAS
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="GWAS.html">GWAS in regenie</a>
    </li>
    <li>
      <a href="plotGWAS.html">Plot GWAS results</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-light fa-salad"></span>
     
    Gene x Vegetarianism GWIS
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="GWIS.html">GWIS in GEM</a>
    </li>
    <li>
      <a href="plotGWIS.html">Plot GWIS results</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Extra
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="GxEplots.html">GxE plots</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Heading 2</li>
    <li>
      <a href="maxunrelated.html">Max unrelated script</a>
    </li>
    <li>
      <a href="page-d.html">Page D</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Define Vegetarians</h1>
<h4 class="author">Mike Francis</h4>
<h4 class="date">2022-09-08 00:53:11</h4>

</div>

<div id="TOC">
<ul>
<li><a
href="#defining-high-quality-vegetarians-for-use-in-this-analysis"
id="toc-defining-high-quality-vegetarians-for-use-in-this-analysis">Defining
“high quality” vegetarians for use in this analysis</a>
<ul>
<li><a href="#purpose-of-this-script"
id="toc-purpose-of-this-script">Purpose of this script:</a></li>
<li><a href="#load-data" id="toc-load-data">Load data</a></li>
<li><a
href="#identify-instances-where-24-hour-dietary-recall-24hr-was-taken-by-participants.-possible-instances-are-0-through-4."
id="toc-identify-instances-where-24-hour-dietary-recall-24hr-was-taken-by-participants.-possible-instances-are-0-through-4.">Identify
instances where 24 hour dietary recall (24HR) was taken by participants.
Possible instances are 0 through 4.</a></li>
<li><a href="#plot-how-many-times-did-participants-take-24hr-surveys"
id="toc-plot-how-many-times-did-participants-take-24hr-surveys">Plot:
How many times did participants take 24HR surveys</a></li>
<li><a
href="#plot-how-many-repeat-participants-were-in-each-instance-of-the-24hr"
id="toc-plot-how-many-repeat-participants-were-in-each-instance-of-the-24hr">Plot:
How many repeat participants were in each instance of the 24HR?</a></li>
<li><a
href="#continue-with-veg-definitions-start-a-new-dataframe-called-new-and-add-age-and-sex-columns"
id="toc-continue-with-veg-definitions-start-a-new-dataframe-called-new-and-add-age-and-sex-columns">Continue
with veg definitions: start a new dataframe called “new” and add Age and
Sex columns</a></li>
<li><a href="#add-major-dietary-change-column"
id="toc-add-major-dietary-change-column">Add “major dietary change”
column</a></li>
<li><a
href="#check-meat-and-fish-eater-fields-of-initial-assessment-ia."
id="toc-check-meat-and-fish-eater-fields-of-initial-assessment-ia.">Check
meat and fish eater fields of initial assessment (IA).</a></li>
<li><a
href="#special-diet-column-in-24hr-where-participants-self-identified-as-vegetarianvegan"
id="toc-special-diet-column-in-24hr-where-participants-self-identified-as-vegetarianvegan">Special
diet column in 24HR where participants self-identified as
vegetarian/vegan</a></li>
<li><a
href="#plot-percent-consistent-vegetarians-vs-number-of-recall-surveys-taken-across-3-years"
id="toc-plot-percent-consistent-vegetarians-vs-number-of-recall-surveys-taken-across-3-years">Plot:
Percent consistent vegetarians vs number of recall survey’s taken across
3 years of 24HR surveys</a></li>
<li><a
href="#identify-those-who-were-vegetarian-at-just-first-24hr-they-took"
id="toc-identify-those-who-were-vegetarian-at-just-first-24hr-they-took">Identify
those who were vegetarian at just first 24HR they took</a></li>
<li><a href="#identify-those-who-ate-meat-or-fish-in-the-24hr"
id="toc-identify-those-who-ate-meat-or-fish-in-the-24hr">Identify those
who ate meat or fish in the 24HR</a></li>
<li><a
href="#plot-those-who-indicated-being-a-vegetarianvegan-and-also-indicated-meat-or-fish-eating-on-that-same-survey"
id="toc-plot-those-who-indicated-being-a-vegetarianvegan-and-also-indicated-meat-or-fish-eating-on-that-same-survey">Plot:
those who indicated being a vegetarian/vegan and also indicated meat or
fish eating on that same survey</a></li>
<li><a href="#create-new-vegetarian-columns"
id="toc-create-new-vegetarian-columns">Create new vegetarian
columns</a></li>
<li><a
href="#table-reason-self-identified-vegetarian-was-disqualified-from-study"
id="toc-table-reason-self-identified-vegetarian-was-disqualified-from-study">Table:
reason self-identified vegetarian was disqualified from study</a></li>
<li><a href="#write-output-files." id="toc-write-output-files.">Write
output files.</a></li>
</ul></li>
</ul>
</div>

<div id="defining-high-quality-vegetarians-for-use-in-this-analysis"
class="section level1">
<h1>Defining “high quality” vegetarians for use in this analysis</h1>
<div id="purpose-of-this-script" class="section level3">
<h3>Purpose of this script:</h3>
<ul>
<li><p>Find the self-identified vegetarians in the UK Biobank dietary
recall survey instances</p></li>
<li><p>Assess their consistency with other parts of the dietary
survey.</p></li>
<li><p>Obtain a list of high quality vegetarians to use for subsequent
analyses.</p></li>
</ul>
<hr />
<p><strong>Veg5yr1 is the vegetarian variable used in the main analysis.
This means:</strong></p>
<ul>
<li><p><strong>Indicated no major dietary changes over past 5
years</strong></p></li>
<li><p><strong>No meat eating on initial assessment
(IA)</strong></p></li>
<li><p><strong>Self-identified as a vegetarian or vegan the first time
they were asked on a 24HR survey</strong></p></li>
<li><p><strong>Didn’t indicate eating any meat or fish on that same
first 24HR survey they took</strong></p></li>
</ul>
<hr />
<p>The biomarker data that we use in this analysis was taken at the IA.
Therefore this is a combination of several columns that describe the
quality of vegetarianism at that same time point.</p>
<p>There are also some plots here showing general qualities of the 24HR
recall survey that were done in my data exploration that don’t factor
into the main analysis (i.e., <a
href="#plot-how-many-repeat-participants-were-in-each-instance-of-the-24hr">Plot:
How many repeat participants were in each instance of the 24HR?</a> , <a
href="#plot-percent-consistent-vegetarians-vs-number-of-recall-surveys-taken-across-3-years">Plot:
Percent consistent vegetarians vs number of recall survey’s taken across
3 years</a>, [Identify those who were vegetarian at two consecutive 24HR
instances])</p>
</div>
<div id="load-data" class="section level3">
<h3>Load data</h3>
<div id="load-packages-special-functions" class="section level4">
<h4>Load packages + special functions</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(silent <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;plyr&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="st">&quot;tidyverse&quot;</span>, <span class="st">&quot;data.table&quot;</span>, <span class="st">&quot;vroom&quot;</span>, <span class="st">&quot;knitr&quot;</span>,<span class="st">&quot;kableExtra&quot;</span>), </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    library, <span class="at">character.only=</span>T))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>table <span class="ot">=</span> <span class="cf">function</span> (..., <span class="at">useNA =</span> <span class="st">&#39;always&#39;</span>) base<span class="sc">::</span><span class="fu">table</span>(..., <span class="at">useNA =</span> useNA)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>mutate_when <span class="ot">&lt;-</span> <span class="cf">function</span>(data, ...) {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    dots <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">substitute</span>(<span class="fu">alist</span>(...)))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(dots), <span class="at">by =</span> <span class="dv">2</span>)) {</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        condition <span class="ot">&lt;-</span> <span class="fu">eval</span>(dots[[i]], <span class="at">envir =</span> data)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        mutations <span class="ot">&lt;-</span> <span class="fu">eval</span>(dots[[i <span class="sc">+</span> <span class="dv">1</span>]], </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">envir =</span> data[condition, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        data[condition, <span class="fu">names</span>(mutations)] <span class="ot">&lt;-</span> mutations</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    data</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="load-uk-biobank-dataset" class="section level4">
<h4>Load UK Biobank dataset</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>bd<span class="ot">=</span><span class="fu">vroom</span>(<span class="st">&quot;/Users/mike/Documents/R_files/UKBpheno/pheno/ukb34137.tab&quot;</span>, <span class="at">delim=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>bd<span class="ot">=</span><span class="fu">as_tibble</span>(bd)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;src/components/ukb34137_factordata.R&quot;</span>) <span class="co">#file provided by UKB &quot;ukb34137_loaddata.R&quot; without the loading part, to label the responses in survey questions</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(bd)</span></code></pre></div>
<pre><code>## [1] 502527   5172</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>bd<span class="ot">=</span><span class="fu">vroom</span>(<span class="st">&quot;/Users/mike/Documents/R_files/UKBpheno/pheno/ukbXXXXX.tab&quot;</span>, <span class="at">delim=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>bd<span class="ot">=</span><span class="fu">as_tibble</span>(bd)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;src/components/ukbXXXXX_factordata.R&quot;</span>) <span class="co">#file provided by UKB &quot;ukbXXXXX_loaddata.R&quot; without the loading part, to label the responses in survey questions</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(bd)</span></code></pre></div>
</div>
</div>
<div
id="identify-instances-where-24-hour-dietary-recall-24hr-was-taken-by-participants.-possible-instances-are-0-through-4."
class="section level3">
<h3>Identify instances where 24 hour dietary recall (24HR) was taken by
participants. Possible instances are 0 through 4.</h3>
<p>“daycols” are days of the week that the 24HR was taken, i.e. a proxy
for whether the survey was completed. In these columns, NA=survey wasn’t
taken that instance.</p>
<p>We change the days of the week to 1 because we’re not interested in
which day it actually was.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>daycols<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;f.20080.0.0&quot;</span>, <span class="st">&quot;f.20080.1.0&quot;</span>, <span class="st">&quot;f.20080.2.0&quot;</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;f.20080.3.0&quot;</span>, <span class="st">&quot;f.20080.4.0&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>bd1<span class="ot">&lt;-</span>bd[,<span class="fu">c</span>(<span class="st">&quot;f.eid&quot;</span>, daycols)]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Change all the factors to characters</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>bd1[,daycols]<span class="ot">&lt;-</span><span class="fu">sapply</span>(bd1[,daycols], as.character)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Change NA&#39;s to zeros and days to 1&#39;s</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>bd1[,daycols][(<span class="fu">is.na</span>(bd1[,daycols]))]<span class="ot">&lt;-</span><span class="st">&quot;0&quot;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>bd1[,daycols][bd1[,daycols]<span class="sc">!=</span><span class="st">&quot;0&quot;</span>] <span class="ot">&lt;-</span><span class="st">&quot;1&quot;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Change these back to numeric</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>bd1[,daycols]<span class="ot">&lt;-</span><span class="fu">sapply</span>(bd1[,daycols], as.integer)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Now make a new column, everyone with rowSums zero never took recall</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#and those with &gt;0 took it at least once</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>bd1<span class="sc">$</span>times_taken_24HR<span class="ot">&lt;-</span><span class="fu">rowSums</span>(bd1[,daycols])</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>bd1<span class="sc">$</span>ever_took_24HR<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>bd1<span class="sc">$</span>ever_took_24HR[bd1<span class="sc">$</span>times_taken_24HR<span class="sc">&gt;</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>bd1<span class="sc">$</span>times_taken_24HR[bd1<span class="sc">$</span>times_taken_24HR<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(bd1<span class="sc">$</span>ever_took_24HR) <span class="co">#[1] 211018</span></span></code></pre></div>
<pre><code>## [1] 211018</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TP = time point</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bd1)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;IID&quot;</span>, <span class="st">&quot;RecallTP0&quot;</span>, <span class="st">&quot;RecallTP1&quot;</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;RecallTP2&quot;</span>,<span class="st">&quot;RecallTP3&quot;</span>,<span class="st">&quot;RecallTP4&quot;</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;times_taken_24HR&quot;</span>, <span class="st">&quot;ever_took_24HR&quot;</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Optional save here</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(bd1, &quot;UKB_24hourRecall-ParticipantInstancesTaken.csv&quot;, quote=F, row.names=F)</span></span></code></pre></div>
<p>During what time periods did the questionnaire cycles occur?</p>
<p><img src="images/paste-31AC8130.png" /></p>
</div>
<div id="plot-how-many-times-did-participants-take-24hr-surveys"
class="section level3">
<h3>Plot: How many times did participants take 24HR surveys</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>perinstance<span class="ot">=</span>bd1<span class="sc">%&gt;%</span><span class="fu">select</span>(RecallTP0<span class="sc">:</span>RecallTP4)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>timestaken<span class="ot">&lt;-</span>bd1<span class="sc">%&gt;%</span><span class="fu">select</span>(times_taken_24HR)<span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(times_taken_24HR)<span class="sc">%&gt;%</span><span class="fu">summarise</span>(<span class="at">N=</span><span class="fu">n</span>())</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>timestaken<span class="sc">%&gt;%</span><span class="fu">kbl</span>()</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
times_taken_24HR
</th>
<th style="text-align:right;">
N
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
84166
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
48119
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
42488
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
30479
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5766
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
291509
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>timestaken, <span class="fu">aes</span>(<span class="at">x=</span>times_taken_24HR, <span class="at">y=</span>N)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">width=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Number of participants&quot;</span>)<span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Number of times taken 24 hour recall&quot;</span>)<span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">&quot;N=&quot;</span>, <span class="fu">sum</span>(timestaken<span class="sc">$</span>N[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]), <span class="at">sep=</span><span class="st">&quot;&quot;</span>))<span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (position_stack).</code></pre>
<p><img src="DefineVeg_files/figure-html/plot-1.png" width="672" /></p>
</div>
<div
id="plot-how-many-repeat-participants-were-in-each-instance-of-the-24hr"
class="section level3">
<h3>Plot: How many repeat participants were in each instance of the
24HR?</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>take<span class="ot">=</span>bd1[<span class="fu">paste</span>(<span class="st">&quot;RecallTP&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>take<span class="ot">=</span>take[<span class="sc">!</span><span class="fu">rowSums</span>(take)<span class="sc">==</span><span class="dv">0</span>,]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>take.plot<span class="ot">=</span>take<span class="sc">%&gt;%</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> v, <span class="at">value =</span> total, RecallTP0<span class="sc">:</span>RecallTP4, <span class="at">na.rm =</span> T)<span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(v)<span class="sc">%&gt;%</span><span class="fu">count</span>(total)<span class="sc">%&gt;%</span><span class="fu">filter</span>(total<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(take.plot)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;RecallTP&quot;</span>, <span class="st">&quot;Group&quot;</span>, <span class="st">&quot;n&quot;</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>take.plot<span class="sc">$</span>RecallTP<span class="ot">=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(take.plot)<span class="sc">%&gt;%</span><span class="fu">kbl</span>()</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
RecallTP
</th>
<th style="text-align:right;">
Group
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
70714
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
100598
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
83265
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
103790
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
100247
</td>
</tr>
</tbody>
</table>
<p>This next script chunk is incredibly repetitive and I’m sure there is
a function for it but it was faster for me to do it “manually”.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>rep<span class="ot">=</span><span class="fu">paste</span>(<span class="st">&quot;repeat&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>take[rep]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>take[rep[<span class="dv">1</span>]]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(take[<span class="sc">!</span><span class="fu">rowSums</span>(take)<span class="sc">==</span><span class="dv">0</span>,])</span></code></pre></div>
<pre><code>## [1] 211018</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TP1, previously took once</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>take<span class="sc">$</span>repeat1[take<span class="sc">$</span>RecallTP0<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                 take<span class="sc">$</span>RecallTP1<span class="sc">==</span><span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#TP2, previously took at least once</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>take<span class="sc">$</span>repeat2[(take<span class="sc">$</span>RecallTP0<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                  take<span class="sc">$</span>RecallTP1<span class="sc">==</span><span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                 take<span class="sc">$</span>RecallTP2<span class="sc">==</span><span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#TP2, previously took twice</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>take<span class="sc">$</span>repeat2[(take<span class="sc">$</span>RecallTP0<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                  take<span class="sc">$</span>RecallTP1<span class="sc">==</span><span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                 take<span class="sc">$</span>RecallTP2<span class="sc">==</span><span class="dv">1</span>] <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#TP3, previously took at least once</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>take<span class="sc">$</span>repeat3[(take<span class="sc">$</span>RecallTP0<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>                take<span class="sc">$</span>RecallTP1<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span> </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>                take<span class="sc">$</span>RecallTP2<span class="sc">==</span><span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>                 take<span class="sc">$</span>RecallTP3<span class="sc">==</span><span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#TP3, previously took at least twice</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>take<span class="sc">$</span>repeat3[(</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    (take<span class="sc">$</span>RecallTP0<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP1<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|</span> </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    (take<span class="sc">$</span>RecallTP1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP2<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    (take<span class="sc">$</span>RecallTP0<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP2<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP3<span class="sc">==</span><span class="dv">1</span>] <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#TP3, previously took three times</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>take<span class="sc">$</span>repeat3[(</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>            take<span class="sc">$</span>RecallTP0<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span>  </span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>            take<span class="sc">$</span>RecallTP1<span class="sc">==</span><span class="dv">1</span>  <span class="sc">&amp;</span> </span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>             take<span class="sc">$</span>RecallTP2<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>             take<span class="sc">$</span>RecallTP3<span class="sc">==</span><span class="dv">1</span>) ] <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co">#TP4, previously took at least once</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>take<span class="sc">$</span>repeat4[(take<span class="sc">$</span>RecallTP0<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> </span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>                  take<span class="sc">$</span>RecallTP1<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span> </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>                  take<span class="sc">$</span>RecallTP2<span class="sc">==</span><span class="dv">1</span><span class="sc">|</span> </span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>                  take<span class="sc">$</span>RecallTP3<span class="sc">==</span><span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>                 take<span class="sc">$</span>RecallTP4<span class="sc">==</span><span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="co">#TP4, previously took at least twice</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>take<span class="sc">$</span>repeat4[(</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    (take<span class="sc">$</span>RecallTP0<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP1<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|</span> </span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    (take<span class="sc">$</span>RecallTP0<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP2<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>    (take<span class="sc">$</span>RecallTP0<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP3<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>    (take<span class="sc">$</span>RecallTP1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP2<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|</span> </span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>    (take<span class="sc">$</span>RecallTP1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP3<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>    (take<span class="sc">$</span>RecallTP2<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP3<span class="sc">==</span><span class="dv">1</span>) </span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP4<span class="sc">==</span><span class="dv">1</span>] <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="co">#TP4, previously took at least three times</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>take<span class="sc">$</span>repeat4[(</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>(take<span class="sc">$</span>RecallTP0<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP2<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>(take<span class="sc">$</span>RecallTP0<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP2<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP3<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>(take<span class="sc">$</span>RecallTP1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP2<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP3<span class="sc">==</span><span class="dv">1</span>) </span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>) <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP4<span class="sc">==</span><span class="dv">1</span>] <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a><span class="co">#TP4, previously took four times</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>take<span class="sc">$</span>repeat4[</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>    take<span class="sc">$</span>RecallTP0<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP1<span class="sc">==</span><span class="dv">1</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>     <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP2<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP3<span class="sc">==</span><span class="dv">1</span> </span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>    <span class="sc">&amp;</span> take<span class="sc">$</span>RecallTP4<span class="sc">==</span><span class="dv">1</span>] <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a><span class="co">#NA for those who didn&#39;t take the recall in that instance</span></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>take<span class="sc">$</span>repeat0[take<span class="sc">$</span>RecallTP0<span class="sc">==</span><span class="dv">0</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>take<span class="sc">$</span>repeat1[take<span class="sc">$</span>RecallTP1<span class="sc">==</span><span class="dv">0</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>take<span class="sc">$</span>repeat2[take<span class="sc">$</span>RecallTP2<span class="sc">==</span><span class="dv">0</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>take<span class="sc">$</span>repeat3[take<span class="sc">$</span>RecallTP3<span class="sc">==</span><span class="dv">0</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>take<span class="sc">$</span>repeat4[take<span class="sc">$</span>RecallTP4<span class="sc">==</span><span class="dv">0</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(take, table)[<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>] <span class="co">#Count repeats at each instance</span></span></code></pre></div>
<pre><code>## $repeat0
## 
##      0   &lt;NA&gt; 
##  70714 140304 
## 
## $repeat1
## 
##      0      1   &lt;NA&gt; 
##  79613  20985 110420 
## 
## $repeat2
## 
##      0      1      2   &lt;NA&gt; 
##  27113  46018  10134 127753 
## 
## $repeat3
## 
##      0      1      2      3   &lt;NA&gt; 
##  19643  38864  37776   7507 107228 
## 
## $repeat4
## 
##      0      1      2      3      4   &lt;NA&gt; 
##  13935  20985  34129  25432   5766 110771</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>take.plot<span class="ot">=</span><span class="fu">data.frame</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">sapply</span>(take, sum)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">row.names =</span> <span class="cn">NULL</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(take.plot)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;RecallTP&quot;</span>, <span class="st">&quot;N&quot;</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">data.frame</span>()</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">=</span>take<span class="sc">%&gt;%</span><span class="fu">group_by_</span>(<span class="fu">paste</span>(<span class="st">&quot;RecallTP&quot;</span>, i,<span class="at">sep=</span><span class="st">&quot;&quot;</span>), <span class="fu">paste</span>(<span class="st">&quot;repeat&quot;</span>,i,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(<span class="at">count=</span><span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rename_</span>(<span class="st">&quot;RecallTP&quot;</span> <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">&quot;RecallTP&quot;</span>, i,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rename_</span>(<span class="st">&quot;group&quot;</span> <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">&quot;repeat&quot;</span>, i,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">=</span>x[x<span class="sc">$</span>RecallTP<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">$</span>RecallTP<span class="ot">=</span>i</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">=</span><span class="fu">rbind</span>(y,x)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;RecallTP0&#39;. You can override using the
## `.groups` argument.
## `summarise()` has grouped output by &#39;RecallTP1&#39;. You can override using the
## `.groups` argument.
## `summarise()` has grouped output by &#39;RecallTP2&#39;. You can override using the
## `.groups` argument.
## `summarise()` has grouped output by &#39;RecallTP3&#39;. You can override using the
## `.groups` argument.
## `summarise()` has grouped output by &#39;RecallTP4&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>y<span class="sc">$</span>group<span class="ot">=</span><span class="fu">mapvalues</span>(y<span class="sc">$</span>group, <span class="at">from=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;First time taking&quot;</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Second time taking&quot;</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Third time taking&quot;</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Fourth time taking&quot;</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Fifth time taking&quot;</span>))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>y<span class="sc">$</span>group<span class="ot">=</span><span class="fu">factor</span>(y<span class="sc">$</span>group, </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">levels =</span><span class="fu">rev</span>(<span class="fu">unique</span>(y<span class="sc">$</span>group)))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>y, <span class="fu">aes</span>(<span class="at">x=</span>RecallTP, <span class="at">y=</span>count, <span class="at">fill=</span>group)) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">width=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Count participants&quot;</span>)<span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Instance of 24 hour recall&quot;</span>)<span class="sc">+</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="DefineVeg_files/figure-html/rep-take-3-1.png" width="672" /></p>
</div>
<div
id="continue-with-veg-definitions-start-a-new-dataframe-called-new-and-add-age-and-sex-columns"
class="section level3">
<h3>Continue with veg definitions: start a new dataframe called “new”
and add Age and Sex columns</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>new<span class="ot">&lt;-</span>bd1</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#PUT AGE AND SEX COLUMNS</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>agesex<span class="ot">&lt;-</span>bd<span class="sc">%&gt;%</span><span class="fu">select</span>(f.eid, f.<span class="dv">21003</span>.<span class="fl">0.0</span>, f.<span class="dv">31</span>.<span class="fl">0.0</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(agesex)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;IID&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Sex&quot;</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>new<span class="ot">&lt;-</span><span class="fu">left_join</span>(new,agesex)<span class="sc">%&gt;%</span><span class="fu">select</span>(IID, Age, Sex, <span class="fu">everything</span>())</span></code></pre></div>
<pre><code>## Joining, by = &quot;IID&quot;</code></pre>
</div>
<div id="add-major-dietary-change-column" class="section level3">
<h3>Add “major dietary change” column</h3>
<p><a
href="https://biobank.ndph.ox.ac.uk/ukb/field.cgi?id=1538">f.1538</a> =
“Have you made any major changes to your diet in the last 5 years?”</p>
<ul>
<li><p>0 = “No”</p></li>
<li><p>1= “Yes, because of illness | Yes, because of other reasons |
Prefer not to answer”</p></li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>changevar<span class="ot">=</span>bd<span class="sc">%&gt;%</span><span class="fu">select</span>(f.eid, f.<span class="dv">1538</span>.<span class="fl">0.0</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(changevar)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;IID&quot;</span>, <span class="st">&quot;DietChanges5yr&quot;</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>changevar[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">sapply</span>(changevar[<span class="dv">2</span>], mapvalues, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="st">&quot;Prefer not to answer&quot;</span>, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Yes, because of illness&quot;</span>, <span class="st">&quot;Yes, because of other reasons&quot;</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;No&quot;</span>),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(changevar<span class="sc">$</span>DietChanges5yr)<span class="sc">%&gt;%</span><span class="fu">kbl</span>()</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Var1
</th>
<th style="text-align:right;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
303495
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
198135
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
897
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>new<span class="ot">=</span><span class="fu">left_join</span>(new,changevar)</span></code></pre></div>
<pre><code>## Joining, by = &quot;IID&quot;</code></pre>
</div>
<div id="check-meat-and-fish-eater-fields-of-initial-assessment-ia."
class="section level3">
<h3>Check meat and fish eater fields of initial assessment (IA).</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Category 100052: Diet. Initial assessment</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>IAcols<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;f.1329.0.0&quot;</span>, <span class="st">&quot;f.1339.0.0&quot;</span>, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;f.1349.0.0&quot;</span>, <span class="st">&quot;f.1359.0.0&quot;</span>, </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;f.1369.0.0&quot;</span>, <span class="st">&quot;f.1379.0.0&quot;</span>, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;f.1389.0.0&quot;</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(IAcols)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;IAOilyfish&quot;</span>, <span class="st">&quot;IANonoilyfish&quot;</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;IAProcessedmeat&quot;</span>,<span class="st">&quot;IAPoultry&quot;</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;IABeef&quot;</span>,<span class="st">&quot;IALamb&quot;</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;IAPork&quot;</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>IAcols.new<span class="ot">&lt;-</span><span class="fu">as_tibble</span>(<span class="fu">sapply</span>(bd[IAcols], as.character))</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(IAcols.new)<span class="ot">&lt;-</span><span class="fu">names</span>(IAcols)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Put a TRUE in this column IAveg if they answered Never in all the meat+fish columns</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>IAcols.new<span class="sc">$</span>IAveg<span class="ot">&lt;-</span><span class="fu">rowSums</span>(bd[IAcols]<span class="sc">==</span><span class="st">&quot;Never&quot;</span>)<span class="sc">==</span><span class="dv">7</span> </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(IAcols.new<span class="sc">$</span>IAveg,<span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="co">#[1] 9129</span></span></code></pre></div>
<pre><code>## [1] 9129</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>IAcols.new<span class="sc">$</span>IID<span class="ot">&lt;-</span>bd<span class="sc">$</span>f.eid</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>new<span class="ot">&lt;-</span><span class="fu">left_join</span>(new, IAcols.new)</span></code></pre></div>
<pre><code>## Joining, by = &quot;IID&quot;</code></pre>
<p>Add the column “Age when last ate meat”</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># IA Age when last ate meat/&quot;Never eaten meat&quot; -----------------------</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">#https://biobank.ndph.ox.ac.uk/ukb/field.cgi?id=3680</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&quot;How old were you when you last ate any kind of meat? </span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">#(Enter &quot;0&quot; if you have never eaten meat in your lifetime)&quot;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">#on the initial assessment</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>IA.ageLastAteMeat<span class="ot">&lt;-</span>bd<span class="sc">%&gt;%</span><span class="fu">select</span>(f.eid, f.<span class="dv">3680</span>.<span class="fl">0.0</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(IA.ageLastAteMeat)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;IID&quot;</span>, <span class="st">&quot;IAageLastAteMeat&quot;</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>new<span class="ot">&lt;-</span><span class="fu">left_join</span>(new, IA.ageLastAteMeat)</span></code></pre></div>
<pre><code>## Joining, by = &quot;IID&quot;</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(new<span class="sc">%&gt;%</span><span class="fu">filter</span>(ever_took_24HR<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> IAveg<span class="sc">==</span><span class="cn">TRUE</span>)) <span class="co">#[1] 4749</span></span></code></pre></div>
<pre><code>## [1] 4749</code></pre>
</div>
<div
id="special-diet-column-in-24hr-where-participants-self-identified-as-vegetarianvegan"
class="section level3">
<h3>Special diet column in 24HR where participants self-identified as
vegetarian/vegan</h3>
<p>This next section solves the problem that if someone has an NA in
field <a
href="https://biobank.ndph.ox.ac.uk/ukb/field.cgi?id=20086">20086</a>
(24hr-recall: special diet followed), it could mean two possible
things:</p>
<ul>
<li><p>They did not answer this question in the affirmative or</p></li>
<li><p>They didn’t take the 24h recall in that instance,</p></li>
</ul>
<p>since it is marked as NA in both of these situations. (I.e. there is
no “I didn’t follow a special diet” response in UKB Data-Coding <a
href="https://biobank.ndph.ox.ac.uk/ukb/coding.cgi?id=76">76</a>).</p>
<p>Therefore response in this column was compared to the column
indicating whether they took the survey in that instance to get that
information.<a href="#fn1" class="footnote-ref"
id="fnref1"><sup>1</sup></a></p>
<p>The question on the survey:</p>
<p><img src="images/paste-9FEB2BC3.png" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>Special<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;f.eid&quot;</span>, <span class="st">&quot;f.20086.0.0&quot;</span>, <span class="st">&quot;f.20086.1.0&quot;</span>,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;f.20086.2.0&quot;</span>, <span class="st">&quot;f.20086.3.0&quot;</span>, <span class="st">&quot;f.20086.4.0&quot;</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Special)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;IID&quot;</span>, <span class="st">&quot;SpecialVeg0&quot;</span>,<span class="st">&quot;SpecialVeg1&quot;</span>, <span class="st">&quot;SpecialVeg2&quot;</span>, </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;SpecialVeg3&quot;</span>, <span class="st">&quot;SpecialVeg4&quot;</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>Special.cols<span class="ot">&lt;-</span><span class="fu">as_tibble</span>(<span class="fu">sapply</span>(bd[Special], as.character))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Special.cols)<span class="ot">&lt;-</span><span class="fu">names</span>(Special)</span></code></pre></div>
<p>The array index for f.20086 runs from 0 to 5 (<a
href="https://biobank.ndph.ox.ac.uk/ukb/field.cgi?id=20086"
class="uri">https://biobank.ndph.ox.ac.uk/ukb/field.cgi?id=20086</a>).
This handy piece of code will consolidate anyone who said vegetarian in
indices 1:5 and put that information in array 0 of the corresponding
survey instance so we don’t have to worry about the additional array
slots for those people that had two special diets.</p>
<p>It also seems that at instance 0 UKB had potentially not enabled this
“multiple special diets” feature as f.20086.0.1:f.20086.0.5 are all
empty in all participants. However in instances 1:4 there are many
participants who indicated multiple special diets.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#to see that f.20086.0.1:f.20086.0.5 are all empty:</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co">#sapply(bd%&gt;%select(f.20086.0.1:f.20086.0.5), table)</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#For vegetarians</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    cols.i<span class="ot">=</span>(<span class="fu">sprintf</span>(<span class="st">&quot;f.20086.%1.0f.%1.0f&quot;</span>, i,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#cols.0=(sprintf(&quot;f.20086.%1.0f.%1.0f&quot;, i,0))</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    Special.cols[<span class="fu">sprintf</span>(<span class="st">&quot;SpecialVeg%1.0f&quot;</span>, i)][</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">apply</span>(bd[cols.i], <span class="dv">1</span>, </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(x) <span class="fu">any</span>(x <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Vegetarian&quot;</span>))),</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>        ]<span class="ot">=</span><span class="st">&quot;Vegetarian&quot;</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co">#For vegans</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    cols.i<span class="ot">=</span>(<span class="fu">sprintf</span>(<span class="st">&quot;f.20086.%1.0f.%1.0f&quot;</span>, i,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#cols.0=(sprintf(&quot;f.20086.%1.0f.%1.0f&quot;, i,0))</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    Special.cols[<span class="fu">sprintf</span>(<span class="st">&quot;SpecialVeg%1.0f&quot;</span>, i)][</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">apply</span>(bd[cols.i], <span class="dv">1</span>, </span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(x) <span class="fu">any</span>(x <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Vegan&quot;</span>))),</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        ]<span class="ot">=</span><span class="st">&quot;Vegan&quot;</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<p>Vegetarian = 1 ; Vegan = 1; all others <strong>and</strong> NA get 0
here, Will switch “true NAs” who didn’t take the survey at this instance
back to NA in next step</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>Special.veg<span class="ot">=</span>Special.cols</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>Special.veg[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>]<span class="ot">&lt;-</span><span class="fu">sapply</span>(Special.cols[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>], mapvalues, </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">&quot;Low calorie&quot;</span>, <span class="st">&quot;Gluten-free&quot;</span>, </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Lactose-free&quot;</span>, <span class="st">&quot;Other&quot;</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Vegetarian&quot;</span>, <span class="st">&quot;Vegan&quot;</span>),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>Special.veg<span class="ot">&lt;-</span><span class="fu">as_tibble</span>(<span class="fu">sapply</span>(Special.veg, as.numeric))</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>new<span class="ot">&lt;-</span><span class="fu">left_join</span>(new, Special.veg)</span></code></pre></div>
<pre><code>## Joining, by = &quot;IID&quot;</code></pre>
<p>Switch those zeros in Special Veg columns back to NAs for those who
didn’t take survey at that instance</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    new[<span class="fu">paste</span>(<span class="st">&quot;SpecialVeg&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)][</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>        new[<span class="fu">paste</span>(<span class="st">&quot;RecallTP&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]<span class="sc">==</span><span class="dv">0</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    ]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Make separate column indicating self-identified <em>vegans</em></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>Special.vegan<span class="ot">&lt;-</span>Special.cols</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>Special.vegan[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>]<span class="ot">&lt;-</span><span class="fu">sapply</span>(Special.cols[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>], mapvalues, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">&quot;Low calorie&quot;</span>, <span class="st">&quot;Gluten-free&quot;</span>, </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Lactose-free&quot;</span>, <span class="st">&quot;Other&quot;</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Vegetarian&quot;</span>, <span class="st">&quot;Vegan&quot;</span>),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Special.vegan)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;IID&quot;</span>, <span class="st">&quot;SpecialVegan0&quot;</span>,<span class="st">&quot;SpecialVegan1&quot;</span>, </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;SpecialVegan2&quot;</span>, </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;SpecialVegan3&quot;</span>, <span class="st">&quot;SpecialVegan4&quot;</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>Special.vegan<span class="ot">&lt;-</span><span class="fu">as_tibble</span>(<span class="fu">sapply</span>(Special.vegan, as.numeric))</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>new<span class="ot">&lt;-</span><span class="fu">left_join</span>(new, Special.vegan)</span></code></pre></div>
<pre><code>## Joining, by = &quot;IID&quot;</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Switch those zeros in Special Veg columns back to NAs </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co">#for those who didn&#39;t take survey at that instance</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    new[<span class="fu">paste</span>(<span class="st">&quot;SpecialVegan&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)][</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>        new[<span class="fu">paste</span>(<span class="st">&quot;RecallTP&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]<span class="sc">==</span><span class="dv">0</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    ]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Find proportion of times each participant answered vegetarian on
24H</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>new<span class="sc">$</span>SpecialTimesVeg<span class="ot">=</span><span class="fu">ifelse</span>(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">apply</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">is.na</span>(new[<span class="fu">paste</span>(<span class="st">&quot;SpecialVeg&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]),<span class="dv">1</span>,all),<span class="cn">NA</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowSums</span>(new[<span class="fu">paste</span>(<span class="st">&quot;SpecialVeg&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)], <span class="at">na.rm =</span> T</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Proportion of times taken 24HR that answered vegetarian</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>new<span class="sc">$</span>SpecialPropVeg<span class="ot">=</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    new<span class="sc">$</span>SpecialTimesVeg<span class="sc">/</span>new<span class="sc">$</span>times_taken_24HR</span></code></pre></div>
</div>
<div
id="plot-percent-consistent-vegetarians-vs-number-of-recall-surveys-taken-across-3-years"
class="section level3">
<h3>Plot: Percent consistent vegetarians vs number of recall survey’s
taken across 3 years of 24HR surveys</h3>
<p>Tracking the percentage of participants who self-identified as
vegetarian every time they took the 24HR (100% of responses were
vegetarian/vegan) versus the number of times the recall was taken by
said participants</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#People who said they were vegetarian at least once</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>times<span class="ot">&lt;-</span>new<span class="sc">%&gt;%</span><span class="fu">select</span>(times_taken_24HR, SpecialTimesVeg)<span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">complete.cases</span>(.), SpecialTimesVeg<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>nveg<span class="ot">=</span><span class="fu">nrow</span>(times)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>times.res<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="dv">5</span>, <span class="at">ncol=</span><span class="dv">4</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    times.res[i,<span class="dv">1</span>]<span class="ot">&lt;-</span>i</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    times.res[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">nrow</span>(times<span class="sc">%&gt;%</span><span class="fu">filter</span>(times_taken_24HR<span class="sc">==</span>i)) </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    times.res[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">nrow</span>(times<span class="sc">%&gt;%</span><span class="fu">filter</span>(SpecialTimesVeg<span class="sc">==</span>i,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                                        times_taken_24HR<span class="sc">==</span>i))</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    times.res[i,<span class="dv">4</span>]<span class="ot">&lt;-</span>(times.res[i,<span class="dv">3</span>]<span class="sc">/</span>times.res[i,<span class="dv">2</span>])<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(times.res)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Times24HR&quot;</span>,</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;N took 24HR this many times and said vegetarian at least once on a survey&quot;</span>, </span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;N who took 24HR this many times said Veg in every 24HR they took&quot;</span>,</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;PercentVeg&quot;</span>)</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>times.res<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(times.res)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>times.res<span class="sc">$</span>Times24HR<span class="ot">&lt;-</span><span class="fu">as.factor</span>(times.res<span class="sc">$</span>Times24HR)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>times.res<span class="sc">%&gt;%</span><span class="fu">kbl</span>()</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Times24HR
</th>
<th style="text-align:right;">
N took 24HR this many times and said vegetarian at least once on a
survey
</th>
<th style="text-align:right;">
N who took 24HR this many times said Veg in every 24HR they took
</th>
<th style="text-align:right;">
PercentVeg
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
2782
</td>
<td style="text-align:right;">
2782
</td>
<td style="text-align:right;">
100.00000
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
2132
</td>
<td style="text-align:right;">
1381
</td>
<td style="text-align:right;">
64.77486
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
2162
</td>
<td style="text-align:right;">
1229
</td>
<td style="text-align:right;">
56.84551
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
1673
</td>
<td style="text-align:right;">
926
</td>
<td style="text-align:right;">
55.34967
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
370
</td>
<td style="text-align:right;">
168
</td>
<td style="text-align:right;">
45.40541
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>times.res, <span class="fu">aes</span>(<span class="at">x=</span>Times24HR,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y=</span>PercentVeg))<span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">width=</span><span class="fl">0.5</span>, <span class="at">fill =</span><span class="st">&quot;#36E072&quot;</span>)<span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">&quot;N=&quot;</span>, nveg,<span class="st">&quot;participants who indicated</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="st">being vegetarian/vegan at least once on</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="st">a 24HR dietary assessment&quot;</span>, <span class="at">sep=</span><span class="st">&quot; &quot;</span>))<span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Times a participant took a 24HR survey</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="st">between April 2009 and June 2012&quot;</span>)<span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;% participants who indicated </span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="st">Vegetarian/Vegan </span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="st">on all recalls taken&quot;</span>)<span class="sc">+</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="DefineVeg_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div
id="identify-those-who-were-vegetarian-at-just-first-24hr-they-took"
class="section level3">
<h3>Identify those who were vegetarian at just first 24HR they took</h3>
<p>(First 24HR is called “next” in the script, as in next after the
initial assessment).</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>specialVeg<span class="ot">=</span>new<span class="sc">%&gt;%</span><span class="fu">select</span>(SpecialVeg0<span class="sc">:</span>SpecialVeg4)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Find positions of all NA&#39;s</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>NonNAindex<span class="ot">=</span><span class="fu">apply</span>(specialVeg, <span class="dv">1</span>,<span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)), </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">simplify =</span> T)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Take first non-NA value</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>specialVeg<span class="sc">$</span>NonNAindex1<span class="ot">=</span><span class="fu">sapply</span>(NonNAindex,<span class="st">&quot;[&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(specialVeg)<span class="sc">%&gt;%</span><span class="fu">kbl</span>()</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
SpecialVeg0
</th>
<th style="text-align:right;">
SpecialVeg1
</th>
<th style="text-align:right;">
SpecialVeg2
</th>
<th style="text-align:right;">
SpecialVeg3
</th>
<th style="text-align:right;">
SpecialVeg4
</th>
<th style="text-align:right;">
NonNAindex1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Find the first time they answered the vegetarianism question:</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>specialVeg<span class="sc">$</span>nextSpecialVeg<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co">#this loop takes a long time but couldn&#39;t figure out how to do it with vectors</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(specialVeg)){</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(specialVeg<span class="sc">$</span>NonNAindex1[i])){</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">#If the first non-NA special Veg = 1, set this to 1</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (specialVeg[i, specialVeg<span class="sc">$</span>NonNAindex1[i]]<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>            {specialVeg<span class="sc">$</span>nextSpecialVeg[i]<span class="ot">=</span><span class="dv">1</span>}</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">#else set to zero</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {specialVeg<span class="sc">$</span>nextSpecialVeg[i]<span class="ot">=</span><span class="dv">0</span>}</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Else set to NA</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{specialVeg<span class="sc">$</span>nextSpecialVeg[i]<span class="ot">=</span><span class="cn">NA</span>}</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Add to main table</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>new<span class="sc">$</span>nextSpecialVeg<span class="ot">=</span>specialVeg<span class="sc">$</span>nextSpecialVeg</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>new<span class="sc">%&gt;%</span><span class="fu">filter</span>(SpecialTimesVeg<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">%&gt;%</span><span class="fu">select</span>(SpecialVeg0<span class="sc">:</span>SpecialVeg4, nextSpecialVeg)<span class="sc">%&gt;%</span><span class="fu">head</span>(<span class="dv">20</span>)<span class="sc">%&gt;%</span><span class="fu">kbl</span>()<span class="sc">%&gt;%</span><span class="fu">row_spec</span>(<span class="dv">18</span>, <span class="at">background=</span><span class="st">&quot;orange&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
SpecialVeg0
</th>
<th style="text-align:right;">
SpecialVeg1
</th>
<th style="text-align:right;">
SpecialVeg2
</th>
<th style="text-align:right;">
SpecialVeg3
</th>
<th style="text-align:right;">
SpecialVeg4
</th>
<th style="text-align:right;">
nextSpecialVeg
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;background-color: orange !important;">
0
</td>
<td style="text-align:right;background-color: orange !important;">
0
</td>
<td style="text-align:right;background-color: orange !important;">
1
</td>
<td style="text-align:right;background-color: orange !important;">
NA
</td>
<td style="text-align:right;background-color: orange !important;">
NA
</td>
<td style="text-align:right;background-color: orange !important;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="identify-those-who-ate-meat-or-fish-in-the-24hr"
class="section level3">
<h3>Identify those who ate meat or fish in the 24HR</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Category 100106: Meat/fish yesterday. 24HR.</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>Meatfish24<span class="ot">&lt;-</span>bd<span class="sc">%&gt;%</span><span class="fu">select</span>(f.<span class="dv">103000</span>.<span class="fl">0.0</span>, f.<span class="dv">103000</span>.<span class="fl">1.0</span>, f.<span class="dv">103000</span>.<span class="fl">2.0</span>, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                        f.<span class="dv">103000</span>.<span class="fl">3.0</span>, f.<span class="dv">103000</span>.<span class="fl">4.0</span>, </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                        f.<span class="dv">103140</span>.<span class="fl">0.0</span>, f.<span class="dv">103140</span>.<span class="fl">1.0</span>, f.<span class="dv">103140</span>.<span class="fl">2.0</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                        f.<span class="dv">103140</span>.<span class="fl">3.0</span>, f.<span class="dv">103140</span>.<span class="fl">4.0</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Meatfish24)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Meat0&quot;</span>, <span class="st">&quot;Meat1&quot;</span>,<span class="st">&quot;Meat2&quot;</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Meat3&quot;</span>,<span class="st">&quot;Meat4&quot;</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Fish0&quot;</span>,<span class="st">&quot;Fish1&quot;</span>,<span class="st">&quot;Fish2&quot;</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Fish3&quot;</span>,<span class="st">&quot;Fish4&quot;</span>)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>Meatfish24<span class="ot">&lt;-</span><span class="fu">as_tibble</span>(<span class="fu">sapply</span>(Meatfish24, </span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>                         mapvalues, <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>Meatfish24<span class="ot">&lt;-</span><span class="fu">as_tibble</span>(<span class="fu">sapply</span>(Meatfish24, as.numeric))</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>Meatfish24</span></code></pre></div>
<pre><code>## # A tibble: 502,527 × 10
##    Meat0 Meat1 Meat2 Meat3 Meat4 Fish0 Fish1 Fish2 Fish3 Fish4
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
##  2    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
##  3     0    NA    NA    NA    NA     0    NA    NA    NA    NA
##  4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
##  5    NA    NA    NA     1     1    NA    NA    NA     1     0
##  6    NA     0     1    NA     1    NA     0     0    NA     0
##  7    NA    NA     0    NA    NA    NA    NA     0    NA    NA
##  8    NA     1    NA     0    NA    NA     1    NA     1    NA
##  9    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
## 10    NA    NA    NA    NA     0    NA    NA    NA    NA     0
## # … with 502,517 more rows</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>Meatfish24<span class="sc">$</span>Meatfish24Sum<span class="ot">&lt;-</span><span class="fu">ifelse</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">apply</span>(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">is.na</span>(Meatfish24),<span class="dv">1</span>,all),<span class="cn">NA</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowSums</span>(Meatfish24, <span class="at">na.rm =</span> T)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>Meatfish24<span class="sc">$</span>IID<span class="ot">&lt;-</span>bd<span class="sc">$</span>f.eid</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>new<span class="ot">&lt;-</span><span class="fu">left_join</span>(new, Meatfish24)</span></code></pre></div>
<pre><code>## Joining, by = &quot;IID&quot;</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>new<span class="sc">$</span>MeatFish24Veg<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>new<span class="sc">$</span>MeatFish24Veg[new<span class="sc">$</span>Meatfish24Sum<span class="sc">==</span><span class="dv">0</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(new<span class="sc">$</span>MeatFish24Veg)</span></code></pre></div>
<pre><code>## 
##      1   &lt;NA&gt; 
##  18638 483889</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>meat2<span class="ot">=</span>new<span class="sc">%&gt;%</span><span class="fu">select</span>(Meat0<span class="sc">:</span>Meat4)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>fish2<span class="ot">=</span>new<span class="sc">%&gt;%</span><span class="fu">select</span>(Fish0<span class="sc">:</span>Fish4)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Find positions of all NA&#39;s</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co">#NonNAindex strategy same as above, identical for Special, Meat and Fish cols.</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>meat2<span class="sc">$</span>NonNAindex1<span class="ot">=</span><span class="fu">sapply</span>(NonNAindex,<span class="st">&quot;[&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>fish2<span class="sc">$</span>NonNAindex1<span class="ot">=</span><span class="fu">sapply</span>(NonNAindex,<span class="st">&quot;[&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Just the first 24HR time point -------------------------------------</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>meat2<span class="sc">$</span>nextMeat24<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co">#0= didn&#39;t eat meat. 1 = ate meat</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(meat2)){</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(meat2<span class="sc">$</span>NonNAindex1[i])){</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (meat2[i, meat2<span class="sc">$</span>NonNAindex1[i]]<span class="sc">==</span><span class="dv">1</span>){meat2<span class="sc">$</span>nextMeat24[i]<span class="ot">=</span><span class="dv">1</span>}</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {meat2<span class="sc">$</span>nextMeat24[i]<span class="ot">=</span><span class="dv">0</span>}</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{meat2<span class="sc">$</span>nextMeat24[i]<span class="ot">=</span><span class="cn">NA</span>}</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>fish2<span class="sc">$</span>nextFish24<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="co">#0= didn&#39;t eat fish. 1 = ate fish</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fish2)){</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(fish2<span class="sc">$</span>NonNAindex1[i])){</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (fish2[i, fish2<span class="sc">$</span>NonNAindex1[i]]<span class="sc">==</span><span class="dv">1</span>){fish2<span class="sc">$</span>nextFish24[i]<span class="ot">=</span><span class="dv">1</span>}</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {fish2<span class="sc">$</span>nextFish24[i]<span class="ot">=</span><span class="dv">0</span>}</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{fish2<span class="sc">$</span>nextFish24[i]<span class="ot">=</span><span class="cn">NA</span>}</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Add to main table</span></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>new<span class="sc">$</span>nextMeat24<span class="ot">=</span>meat2<span class="sc">$</span>nextMeat24</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>new<span class="sc">$</span>nextFish24<span class="ot">=</span>fish2<span class="sc">$</span>nextFish24</span></code></pre></div>
</div>
<div
id="plot-those-who-indicated-being-a-vegetarianvegan-and-also-indicated-meat-or-fish-eating-on-that-same-survey"
class="section level3">
<h3>Plot: those who indicated being a vegetarian/vegan and also
indicated meat or fish eating on that same survey</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ate&lt;-dat[c(17:21, 35:44)]</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>ate<span class="ot">=</span>new<span class="sc">%&gt;%</span><span class="fu">select</span>(SpecialVeg0<span class="sc">:</span>SpecialVeg4, Meat0<span class="sc">:</span>Fish4)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize four categories as columns in data frame &quot;ate&quot;</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>Vegatemeat<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">&quot;vegAteMeatOnly&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>ate[Vegatemeat]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>Vegatefish<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">&quot;vegAteFishOnly&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>ate[Vegatefish]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>Vegatemeatandfish<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">&quot;vegAteMeatAndFish&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>ate[Vegatemeatandfish]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>Vegdidnt<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">&quot;vegDidnt&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>ate[Vegdidnt]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Loop over instances 0:4 of 24HR survey</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">sum</span>(ate[<span class="fu">paste</span>(<span class="st">&quot;SpecialVeg&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]<span class="sc">==</span><span class="dv">1</span>, <span class="at">na.rm=</span>T), <span class="st">&quot;self-identified veg at tp&quot;</span>, i))</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    ate[<span class="fu">paste</span>(<span class="st">&quot;vegAteMeatOnly&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)][</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>        ate[<span class="fu">paste</span>(<span class="st">&quot;Meat&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>        ate[<span class="fu">paste</span>(<span class="st">&quot;Fish&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>        ate[<span class="fu">paste</span>(<span class="st">&quot;SpecialVeg&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]<span class="sc">==</span><span class="dv">1</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>        ]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>    ate[<span class="fu">paste</span>(<span class="st">&quot;vegAteFishOnly&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)][</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>        ate[<span class="fu">paste</span>(<span class="st">&quot;Meat&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>        ate[<span class="fu">paste</span>(<span class="st">&quot;Fish&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>        ate[<span class="fu">paste</span>(<span class="st">&quot;SpecialVeg&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]<span class="sc">==</span><span class="dv">1</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>        ]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>    ate[<span class="fu">paste</span>(<span class="st">&quot;vegAteMeatAndFish&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)][</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>        ate[<span class="fu">paste</span>(<span class="st">&quot;Meat&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>            ate[<span class="fu">paste</span>(<span class="st">&quot;Fish&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>            ate[<span class="fu">paste</span>(<span class="st">&quot;SpecialVeg&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]<span class="sc">==</span><span class="dv">1</span></span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>    ]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>    ate[<span class="fu">paste</span>(<span class="st">&quot;vegDidnt&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)][</span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>        ate[<span class="fu">paste</span>(<span class="st">&quot;Meat&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>        ate[<span class="fu">paste</span>(<span class="st">&quot;Fish&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>        ate[<span class="fu">paste</span>(<span class="st">&quot;SpecialVeg&quot;</span>, i, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)]<span class="sc">==</span><span class="dv">1</span></span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>        ]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;2516 self-identified veg at tp 0&quot;
## [1] &quot;3987 self-identified veg at tp 1&quot;
## [1] &quot;3242 self-identified veg at tp 2&quot;
## [1] &quot;4053 self-identified veg at tp 3&quot;
## [1] &quot;3884 self-identified veg at tp 4&quot;</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ate)</span></code></pre></div>
<pre><code>##  [1] &quot;SpecialVeg0&quot;        &quot;SpecialVeg1&quot;        &quot;SpecialVeg2&quot;       
##  [4] &quot;SpecialVeg3&quot;        &quot;SpecialVeg4&quot;        &quot;Meat0&quot;             
##  [7] &quot;Meat1&quot;              &quot;Meat2&quot;              &quot;Meat3&quot;             
## [10] &quot;Meat4&quot;              &quot;Fish0&quot;              &quot;Fish1&quot;             
## [13] &quot;Fish2&quot;              &quot;Fish3&quot;              &quot;Fish4&quot;             
## [16] &quot;vegAteMeatOnly0&quot;    &quot;vegAteMeatOnly1&quot;    &quot;vegAteMeatOnly2&quot;   
## [19] &quot;vegAteMeatOnly3&quot;    &quot;vegAteMeatOnly4&quot;    &quot;vegAteFishOnly0&quot;   
## [22] &quot;vegAteFishOnly1&quot;    &quot;vegAteFishOnly2&quot;    &quot;vegAteFishOnly3&quot;   
## [25] &quot;vegAteFishOnly4&quot;    &quot;vegAteMeatAndFish0&quot; &quot;vegAteMeatAndFish1&quot;
## [28] &quot;vegAteMeatAndFish2&quot; &quot;vegAteMeatAndFish3&quot; &quot;vegAteMeatAndFish4&quot;
## [31] &quot;vegDidnt0&quot;          &quot;vegDidnt1&quot;          &quot;vegDidnt2&quot;         
## [34] &quot;vegDidnt3&quot;          &quot;vegDidnt4&quot;</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>ate<span class="ot">=</span>ate[<span class="dv">16</span><span class="sc">:</span><span class="dv">35</span>]</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>ate</span></code></pre></div>
<pre><code>## # A tibble: 502,527 × 20
##    vegAteMeatOnly0 vegAteMeatOnly1 vegAteMeatOnly2 vegAteMeatOnly3
##              &lt;dbl&gt;           &lt;dbl&gt;           &lt;dbl&gt;           &lt;dbl&gt;
##  1              NA              NA              NA              NA
##  2              NA              NA              NA              NA
##  3              NA              NA              NA              NA
##  4              NA              NA              NA              NA
##  5              NA              NA              NA              NA
##  6              NA              NA              NA              NA
##  7              NA              NA              NA              NA
##  8              NA              NA              NA              NA
##  9              NA              NA              NA              NA
## 10              NA              NA              NA              NA
## # … with 502,517 more rows, and 16 more variables: vegAteMeatOnly4 &lt;dbl&gt;,
## #   vegAteFishOnly0 &lt;dbl&gt;, vegAteFishOnly1 &lt;dbl&gt;, vegAteFishOnly2 &lt;dbl&gt;,
## #   vegAteFishOnly3 &lt;dbl&gt;, vegAteFishOnly4 &lt;dbl&gt;, vegAteMeatAndFish0 &lt;dbl&gt;,
## #   vegAteMeatAndFish1 &lt;dbl&gt;, vegAteMeatAndFish2 &lt;dbl&gt;,
## #   vegAteMeatAndFish3 &lt;dbl&gt;, vegAteMeatAndFish4 &lt;dbl&gt;, vegDidnt0 &lt;dbl&gt;,
## #   vegDidnt1 &lt;dbl&gt;, vegDidnt2 &lt;dbl&gt;, vegDidnt3 &lt;dbl&gt;, vegDidnt4 &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>ate.plot<span class="ot">&lt;-</span>ate<span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(v, value,vegAteMeatOnly0<span class="sc">:</span>vegDidnt4, <span class="at">na.rm =</span> T)<span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(v)<span class="sc">%&gt;%</span><span class="fu">count</span>(value)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(ate.plot)</span></code></pre></div>
<pre><code>## # A tibble: 20 × 3
##    v                  value     n
##    &lt;chr&gt;              &lt;dbl&gt; &lt;int&gt;
##  1 vegAteFishOnly0        1   214
##  2 vegAteFishOnly1        1   312
##  3 vegAteFishOnly2        1   236
##  4 vegAteFishOnly3        1   255
##  5 vegAteFishOnly4        1   269
##  6 vegAteMeatAndFish0     1    19
##  7 vegAteMeatAndFish1     1    20
##  8 vegAteMeatAndFish2     1    12
##  9 vegAteMeatAndFish3     1    15
## 10 vegAteMeatAndFish4     1    19
## 11 vegAteMeatOnly0        1    76
## 12 vegAteMeatOnly1        1    75
## 13 vegAteMeatOnly2        1    71
## 14 vegAteMeatOnly3        1   100
## 15 vegAteMeatOnly4        1    86
## 16 vegDidnt0              1  2207
## 17 vegDidnt1              1  3580
## 18 vegDidnt2              1  2923
## 19 vegDidnt3              1  3683
## 20 vegDidnt4              1  3510</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>ate.plot<span class="ot">=</span>ate.plot<span class="sc">%&gt;%</span><span class="fu">separate</span>(v, <span class="at">into=</span><span class="fu">c</span>(<span class="st">&quot;group&quot;</span>, <span class="st">&quot;TP&quot;</span>), <span class="at">sep=</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">convert=</span>T)<span class="sc">%&gt;%</span><span class="fu">select</span>(<span class="sc">-</span>value)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(ate.plot)</span></code></pre></div>
<pre><code>##                group TP    n
## 1     vegAteFishOnly  0  214
## 2     vegAteFishOnly  1  312
## 3     vegAteFishOnly  2  236
## 4     vegAteFishOnly  3  255
## 5     vegAteFishOnly  4  269
## 6  vegAteMeatAndFish  0   19
## 7  vegAteMeatAndFish  1   20
## 8  vegAteMeatAndFish  2   12
## 9  vegAteMeatAndFish  3   15
## 10 vegAteMeatAndFish  4   19
## 11    vegAteMeatOnly  0   76
## 12    vegAteMeatOnly  1   75
## 13    vegAteMeatOnly  2   71
## 14    vegAteMeatOnly  3  100
## 15    vegAteMeatOnly  4   86
## 16          vegDidnt  0 2207
## 17          vegDidnt  1 3580
## 18          vegDidnt  2 2923
## 19          vegDidnt  3 3683
## 20          vegDidnt  4 3510</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>ate.plot<span class="sc">$</span>group<span class="ot">=</span><span class="fu">mapvalues</span>(ate.plot<span class="sc">$</span>group,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">from=</span><span class="fu">unique</span>(ate.plot<span class="sc">$</span>group),</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;Ate fish&quot;</span>, <span class="st">&quot;Ate meat and fish&quot;</span>,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;Ate meat&quot;</span>, <span class="st">&quot;Did not eat meat or fish&quot;</span>))</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>prop<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">=</span>ate.plot[ate.plot<span class="sc">$</span>TP<span class="sc">==</span>i,]</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    prop[i<span class="sc">+</span><span class="dv">1</span>]<span class="ot">=</span><span class="fu">sum</span>(y<span class="sc">$</span>n[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])<span class="sc">/</span>y<span class="sc">$</span>n[<span class="dv">4</span>]</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    prop[i<span class="sc">+</span><span class="dv">1</span>]<span class="ot">=</span><span class="fu">round</span>(prop[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>ate.plot<span class="ot">=</span>ate.plot<span class="sc">%&gt;%</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>       <span class="fu">mutate_when</span>(group<span class="sc">==</span><span class="st">&quot;Did not eat meat or fish&quot;</span>, <span class="fu">list</span>(<span class="at">value=</span>prop))</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>plot<span class="ot">=</span><span class="fu">ggplot</span>(<span class="at">data=</span>ate.plot, <span class="fu">aes</span>(<span class="at">x=</span>TP, <span class="at">y=</span>n, <span class="at">fill=</span>group)) <span class="sc">+</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;stack&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">width=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Self-identified &#39;vegetarian/vegan&#39; who indicated meat or fish eating </span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="st">on the same 24HR survey instance&quot;</span>)<span class="sc">+</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>, </span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;green&quot;</span>, <span class="st">&quot;grey&quot;</span>))<span class="sc">+</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Instance of 24 hour recall&quot;</span>)<span class="sc">+</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">4200</span>)<span class="sc">+</span></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(value), <span class="st">&quot;&quot;</span>,</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">paste</span>(value, <span class="st">&quot;%&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)), <span class="at">vjust=</span><span class="sc">-</span><span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">&quot;Vegetarian/vegan who:&quot;</span>)<span class="sc">+</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Number of participants&quot;</span>)</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>plot</span></code></pre></div>
<p><img src="DefineVeg_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write plot to tiff</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tiff(filename=&quot;veg.atemeatorfish.tiff&quot;, width=6, height=4, units=&#39;in&#39;, res=600)</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code></pre></div>
</div>
<div id="create-new-vegetarian-columns" class="section level3">
<h3>Create new vegetarian columns</h3>
<p>Veg5yr1 is the vegetarian variable used in the main analysis. Again
the criteria are:</p>
<ul>
<li><p>Indicated no dietary changes over past 5 years</p></li>
<li><p>Consistent no meat eating on initial assessment</p></li>
<li><p>Self-identified as a vegetarian or vegan the first time they were
asked on a 24HR survey</p></li>
<li><p>Didn’t indicate eating any meat or fish on that same 24HR
survey</p></li>
</ul>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>new<span class="sc">$</span>Veg5yr1<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>new<span class="sc">$</span>Veg5yr1[new<span class="sc">$</span>DietChanges5yr<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>             new<span class="sc">$</span>IAveg<span class="sc">==</span><span class="cn">TRUE</span> <span class="sc">&amp;</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>             new<span class="sc">$</span>nextSpecialVeg<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>             new<span class="sc">$</span>nextMeat24<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>             new<span class="sc">$</span>nextFish24<span class="sc">==</span><span class="dv">0</span>]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>new<span class="sc">$</span>Veg5yr1[<span class="fu">is.na</span>(new<span class="sc">$</span>times_taken_24HR)]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(new<span class="sc">$</span>Veg5yr1) <span class="co">#3207</span></span></code></pre></div>
<pre><code>## 
##      0      1   &lt;NA&gt; 
## 207811   3207 291509</code></pre>
</div>
<div
id="table-reason-self-identified-vegetarian-was-disqualified-from-study"
class="section level3">
<h3>Table: reason self-identified vegetarian was disqualified from
study</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>dq<span class="ot">=</span>new<span class="sc">%&gt;%</span><span class="fu">select</span>(Veg5yr1, DietChanges5yr, IAveg, nextSpecialVeg, nextMeat24, nextFish24, SpecialTimesVeg)<span class="sc">%&gt;%</span><span class="fu">filter</span>(SpecialTimesVeg<span class="sc">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(dq) <span class="co">#9119 participants who ever said they were vegetarian</span></span></code></pre></div>
<pre><code>## [1] 9119</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>dq<span class="sc">$</span>nextMeatFish24<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>dq<span class="sc">$</span>nextMeatFish24[dq<span class="sc">$</span>nextMeat24<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> dq<span class="sc">$</span>nextFish24<span class="sc">==</span><span class="dv">1</span>]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>dq1<span class="ot">=</span><span class="fu">as.data.frame</span>(dq<span class="sc">%&gt;%</span><span class="fu">group_by</span>(nextSpecialVeg, IAveg, nextMeatFish24, DietChanges5yr)<span class="sc">%&gt;%</span><span class="fu">summarize</span>(<span class="fu">n</span>()))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;nextSpecialVeg&#39;, &#39;IAveg&#39;,
## &#39;nextMeatFish24&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>dq1<span class="sc">$</span>nextSpecialVeg<span class="ot">=</span><span class="fu">mapvalues</span>(dq1<span class="sc">$</span>nextSpecialVeg, <span class="at">from=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>))</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>dq1<span class="sc">$</span>IAveg<span class="ot">=</span><span class="fu">mapvalues</span>(dq1<span class="sc">$</span>IAveg, <span class="at">from=</span><span class="fu">c</span>(<span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>),</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>)) <span class="co">#reversing the point of this column from &quot;were they veg&quot; to &quot;did they eat meat&quot;</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>dq1<span class="sc">$</span>nextMeatFish24<span class="ot">=</span><span class="fu">mapvalues</span>(dq1<span class="sc">$</span>nextMeatFish24, <span class="at">from=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>))</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>dq1<span class="sc">$</span>DietChanges5yr<span class="ot">=</span><span class="fu">mapvalues</span>(dq1<span class="sc">$</span>DietChanges5yr, <span class="at">from=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">to=</span><span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>))</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dq1)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Veg. on first 24HR taken&quot;</span>,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Ate meat/fish on initial assessment&quot;</span>,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Ate meat/fish on first 24HR taken&quot;</span>,</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Major dietary changes past 5 years&quot;</span>,</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;N&quot;</span>)</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>novegfirst<span class="ot">=</span><span class="fu">unlist</span>(dq1<span class="sc">%&gt;%</span><span class="fu">filter</span>(<span class="st">`</span><span class="at">Veg. on first 24HR taken</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;No&quot;</span>)<span class="sc">%&gt;%</span><span class="fu">summarize</span>(<span class="fu">sum</span>(N)))</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>dq1<span class="sc">%&gt;%</span><span class="fu">add_row</span>(<span class="st">`</span><span class="at">Veg. on first 24HR taken</span><span class="st">`</span><span class="ot">=</span><span class="st">&quot;No&quot;</span>, <span class="at">N=</span><span class="dv">1000</span>)</span></code></pre></div>
<pre><code>##    Veg. on first 24HR taken Ate meat/fish on initial assessment
## 1                        No                                 Yes
## 2                        No                                 Yes
## 3                        No                                 Yes
## 4                        No                                 Yes
## 5                        No                                  No
## 6                        No                                  No
## 7                        No                                  No
## 8                        No                                  No
## 9                        No                                &lt;NA&gt;
## 10                      Yes                                 Yes
## 11                      Yes                                 Yes
## 12                      Yes                                 Yes
## 13                      Yes                                 Yes
## 14                      Yes                                  No
## 15                      Yes                                  No
## 16                      Yes                                  No
## 17                      Yes                                  No
## 18                      Yes                                &lt;NA&gt;
## 19                       No                                &lt;NA&gt;
##    Ate meat/fish on first 24HR taken Major dietary changes past 5 years    N
## 1                                 No                                 No  289
## 2                                 No                                Yes  226
## 3                                Yes                                 No  372
## 4                                Yes                                Yes  300
## 5                                 No                                 No   71
## 6                                 No                                Yes   60
## 7                                Yes                                 No    3
## 8                                Yes                                Yes    5
## 9                                 No                               &lt;NA&gt;    2
## 10                                No                                 No 1629
## 11                                No                                Yes  932
## 12                               Yes                                 No  490
## 13                               Yes                                Yes  369
## 14                                No                                 No 3207
## 15                                No                                Yes 1136
## 16                               Yes                                 No   11
## 17                               Yes                                Yes   11
## 18                                No                               &lt;NA&gt;    6
## 19                              &lt;NA&gt;                               &lt;NA&gt; 1000</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://haozhu233.github.io/kableExtra/awesome_table_in_html.html</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>dq1<span class="sc">%&gt;%</span><span class="fu">filter</span>(<span class="st">`</span><span class="at">Veg. on first 24HR taken</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;Yes&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_row</span>(<span class="st">`</span><span class="at">Veg. on first 24HR taken</span><span class="st">`</span><span class="ot">=</span><span class="st">&quot;No&quot;</span>, </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Ate meat/fish on initial assessment</span><span class="st">`</span><span class="ot">=</span><span class="st">&quot;&quot;</span>, </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Ate meat/fish on first 24HR taken</span><span class="st">`</span><span class="ot">=</span><span class="st">&quot;&quot;</span>, </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Major dietary changes past 5 years</span><span class="st">`</span><span class="ot">=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">N=</span>novegfirst)<span class="sc">%&gt;%</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Veg. on first 24HR taken</span><span class="st">`</span>),</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Ate meat/fish on initial assessment</span><span class="st">`</span>)<span class="sc">%&gt;%</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>(<span class="at">align=</span><span class="st">&quot;c&quot;</span>, <span class="at">caption=</span><span class="st">&quot;Survey results for 9119 participants who self-identified as vegetarians at least once&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>(<span class="at">full_width =</span> F)<span class="sc">%&gt;%</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="dv">1</span>, <span class="at">background=</span><span class="st">&quot;#36E072&quot;</span>)</span></code></pre></div>
<table class=" lightable-classic-2" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Survey results for 9119 participants who self-identified as vegetarians
at least once
</caption>
<thead>
<tr>
<th style="text-align:center;">
Veg. on first 24HR taken
</th>
<th style="text-align:center;">
Ate meat/fish on initial assessment
</th>
<th style="text-align:center;">
Ate meat/fish on first 24HR taken
</th>
<th style="text-align:center;">
Major dietary changes past 5 years
</th>
<th style="text-align:center;">
N
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;background-color: #36E072 !important;">
Yes
</td>
<td style="text-align:center;background-color: #36E072 !important;">
No
</td>
<td style="text-align:center;background-color: #36E072 !important;">
No
</td>
<td style="text-align:center;background-color: #36E072 !important;">
No
</td>
<td style="text-align:center;background-color: #36E072 !important;">
3207
</td>
</tr>
<tr>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
No
</td>
<td style="text-align:center;">
No
</td>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
1136
</td>
</tr>
<tr>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
No
</td>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
No
</td>
<td style="text-align:center;">
11
</td>
</tr>
<tr>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
No
</td>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
11
</td>
</tr>
<tr>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
No
</td>
<td style="text-align:center;">
No
</td>
<td style="text-align:center;">
1629
</td>
</tr>
<tr>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
No
</td>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
932
</td>
</tr>
<tr>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
No
</td>
<td style="text-align:center;">
490
</td>
</tr>
<tr>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
369
</td>
</tr>
<tr>
<td style="text-align:center;">
Yes
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
No
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
6
</td>
</tr>
<tr>
<td style="text-align:center;">
No
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
1328
</td>
</tr>
</tbody>
</table>
</div>
<div id="write-output-files." class="section level3">
<h3>Write output files.</h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Write output ------------------------------------------</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(new, <span class="st">&quot;DefineVeg-09062022.csv&quot;</span>, <span class="at">row.names=</span>F, <span class="at">quote=</span>F)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>vegonly<span class="ot">=</span>new<span class="sc">%&gt;%</span><span class="fu">filter</span>(SpecialPropVeg<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(vegonly, <span class="st">&quot;Vegonly-09062022.csv&quot;</span>, <span class="at">row.names=</span>F, <span class="at">quote=</span>F)</span></code></pre></div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>This seemed unnecessarily complicated, so I verified
with UKB and they confirmed:</p>
<p>“If a day is recorded in field 20080-x.0, but a null value is given
for field 20086-x.0, then it means that the participant did not follow
any of the six possible special diets during that period. Each diet that
they did follow is recorded sequentially in fields 20086-x.0 through
20086-x.5 (i.e. the last is only populated if all diets were selected).
No entry in field 20080-x.0 indicates the participant did not complete
instance x of the dietary questionnaire (and all of 20086-x.0 through
20086-x.5 will be empty).”</p>
<p>–Sean Watson, UK Biobank data analyst, 8/31/2022<a href="#fnref1"
class="footnote-back">↩︎</a></p></li>
</ol>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
